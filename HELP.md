## 关于： 

- 一个重启菜单应用.包括重启和关机(默认和强制模式),重启至recovery和bootloader,热重启,重启用户界面,安全模式和锁屏.无root环境下亦可使用(功能受限).
帮助： 如果在root模式下执行失败,手机没有任何反应,请检查本应用是否得到root权限或安装**busybox**补足Linux二进制试试,还可以切换到**强制模式**再尝试操作. 

### 功能解释：

0.切换模式:切换至强制模式或默认模式,使用强制模式的功能加上*标记.

(注意:4.3或以下**不支持**默认模式,将自动切换成**强制模式**)

1.强制模式中的重启和关机：调用linux中的命令.强制切断设备电源,执行速度快,成功率高,但是有极小的可能性会导致**文件损坏**甚至**系统崩溃**.

2.默认模式中的重启和关机：调用Android系统电源管理模块.速度慢,有一点执行失败的可能性(一直显示正在xx的对话),但是更加安全.

3.recovery:恢复模式.

4.bootloader,亦称**fastboot**模式,线刷模式.

5.热重启,在保持设备硬件通电的情况下,关闭并重新加载系统.

6.重启用户界面,重启**com.android.systemui**,用于刷新桌面UI,重新加载桌面小部件或刷新图标显示.

7.安全模式：重启系统停用所有第三方应用,用于排查有问题的应用并恢复系统.

(备注：**强制模式**下的**安全模式**在某些环境下可能会失效)

8.锁屏：通过模拟按下电源键熄灭屏幕. 

注意：设备管理器和辅助服务是为免root模式准备的.已经root的用户,完全不需要打开这个应用的设备管理器和辅助服务.

### 配置文件帮助：

本应用已经为用户做好了万全的选项操作设计,因此**不推荐**使用任何自定义的配置选项.不过如果需要,也可以通过在特定的目录创建文件解决.

在手机**内置存储(/storage/emulated/0/)中的/Android/data/com.ryuunoakaihitomi.rebootmenu/files/**
中加入相应文件名的**空文件或文件夹**.加入wt启用白色主题,加入c可以返回键退出,加入nntc取消显示确认对话直接执行命令,加入dncr启动时不检查root权限,加入urm在启动时不检查root权限的基础上手动开启免root模式.

## 免root模式帮助
- 包括锁屏和调用系统电源菜单.
- 从**Android 7.0**开始支持重启,(需要执行**device owner**)

(免root模式下) 功能解释：

1.锁屏：锁定屏幕(注意：这种模式下的锁屏有可能失去某些**快捷解锁**的功能,例如：**需要重新输入密码**)

2.打开系统电源菜单：调用系统电源菜单,效果与长按电源键相同

3.重启：类比root默认模式重启

注意：没有获取到root权限的启动选项功能将会受到限制,你需要手动打开**设备管理器**来实现锁屏,并且只有打开**辅助(无障碍)服务**时才能调用系统的电源菜单.
emui或者其他后台管理异常严格的系统环境用户请将本应用的后台卡片锁定以防止辅助服务被杀,并且需要注意**不要**通过本应用保留的**后台卡片**来启动本应用.
只有Android5.0或以上才能使用调用系统电源菜单功能,而且有极少可能会出现点击调用系统电源菜单功能无反应的情况,这时请自行**重新打开**辅助服务开关,如果你开启了辅助服务但进入了**root**模式,在Android 7.0或以上系统中辅助服务会**自动关闭**.

快捷方式：**长按**本应用的某个功能选项可以在启动器添加相应功能的快捷方式.只支持**root**模式**强制**和免root模式所有功能.

面向较高系统版本,本应用在Android7.0和7.1及以上系统中分别增加了**状态栏下拉图块(Tile)**
和对支持的启动器增设了**长按应用图标即可弹出的快捷方式菜单(App Shortcut)**~~(注意：由于系统限制,最长快捷菜单为**5**个,因此会有部分功能快捷菜单没有显示)~~,该菜单**至少正常运行过本应用一次**才可用.如进入过root模式,根据功能是否可用添加相应图块.如进入过免root模式,则选项和对话框模式相同,只是不是二次确认模式.而图块的功能和使用方法同启动器应用图标相同
(为防止误操作,在锁屏模式下禁止使用图块).

device owner(设备所有者权限申请)：使用**ADB调试**,执行命令

**adb shell dpm set-device-owner com.ryuunoakaihitomi.rebootmenu/.AdminReceiver**

显示以Success打头的信息即表示成功,可以使用免root重启功能.

注意：注册为设备所有者后,不能够**卸载**或**停用**本应用,也不能够取消本应用的**设备管理器**(无法对免root模式的锁屏进行二次确认).如果想反注册之,请点击**解除Device Owner身份**选项.届时将禁用重启,并且**仍需ADB才能开启**.如果在授权时出现错误或长时间停滞,请设法在**设置**中删除所有**账号/用户/访客模式/工作资料/其他应用的设备所有者权限**(在其应用中解除),并确保**ADB具有所有权限/非重复申请**.
### 特殊免root模式：

这种模式仅在**部分环境**中有效,原理是执行普通权限而非root权限的shell.
需要设置dncr不检查root权限再选择强制模式启用.支持的功能随环境差异可能有所不同
~~(有待研究)~~.在长按图标菜单中只有reboot系(需要调用reboot命令的)功能可在此模式下使用.

# 实验性

以下功能或特性可能随需求更改或删除,~~请不要过于依赖这些~~.

- 在**内置存储根目录**中加**rebootmenuLog**文件名空文件,打印标签为rebootmenu的调试日志.可以在**ADB Shell**中用

  **logcat -s rebootmenu**
  
  命令查看.(当本应用工作不正常,反馈时请携带此调试日志)
- **长按**图块弹出**音量调节**面板.
- 安装为**系统应用**后,使用一个系统API接口而不是用命令来实现重启.通常这样做能够提高稳定性和安全性.

# (≧∇≦)/

开发者：

@ryuunoakaihitomi github.com